# Filebeat instructions (Linux + Docker)

In this project Filebeat is used to read the logs from the docker containers, process them and pass them on to the Logstash for further matching and indexing.

## Configuration

For configuration of Filebeat, filebeat.yml file is used.

The owner of the configuration file must be either root or the user who is executing the Beat process.
Check out the [possible errors](https://www.elastic.co/guide/en/beats/libbeat/current/config-file-permissions.html)

Filebeat supports multiline logs with a bit of configuration.
Example:
```
multiline.pattern: 'regular_expression'
multiline.negate: true
multiline.match: after
```
- Take the line that matches the pattern
- Every line that comes after that and doesn't match the provided pattern will be considered to be the part of the first line

More on multiline matching in filebeat [multiline examples](https://www.elastic.co/guide/en/beats/filebeat/current/multiline-examples.html). 

## Docker compose

To use the filebeat, custom image is created, with simple setup to change the ownership of the configuration file, and set the reading permissions.

Filebeat container has to be run by the root user to be able to read all the logs generated by all application.
`user: root #To read the docker socket`
By reading the docker.sock we can add more metadata to container logs such as container name.

Filebeat container needs the access to the container logs which will be mounted as a read-only volume.

